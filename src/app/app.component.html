<!--app.component.html-->
<div class="app-container">
  <header class="app-header">
    <h1>🎫 Accreditation Card Manager</h1>
  </header>

  <main class="main-content">
    <button (click)="createNewCard()" class="btn-global btn-success">➕ Create New Card</button>

    <!--View Mode-->
    <div *ngIf="viewMode === 'view'" class="view-mode">
      <!--Card Selection-->
      <div class="card-selector">
        <h3>📋 Select Card to Display:</h3>
        <div class="selector-buttons">
          <button
            *ngFor="let card of cards; let i = index"
            (click)="selectCard(i)"
            [class.active]="selectedCardIndex === i"
            [class]="'btn-' + getCardFunction(card)">
            {{getCardDisplayName(card)}} ({{getCardFunction(card).toUpperCase()}})
          </button>
        </div>
      </div>

      <!--Current Card Display-->
      <div class="current-card-section" *ngIf="currentCard">
        <div class="view-toggle">
          <button (click)="switchToViewMode()" [class.active]="viewMode === 'view'" class="toggle-btn view-btn">👁️ View Mode</button>
          <button (click)="switchToEditMode()" [class.active]="false" class="toggle-btn edit-btn">✏️ Edit Mode</button>
        </div>

        <div class="card-header">
          <h3>Current Card: {{getCardDisplayName(currentCard)}}</h3>
          <div class="card-actions">
            <button (click)="exportCurrentCardAsPDF()" class="btn-action btn-primary">📄 Export PDF</button>
            <button (click)="deleteCurrentCard()" class="btn-global btn-danger" *ngIf="currentCard">🗑️ Delete Current Card</button>
            <button (click)="exportCurrentCardAsImage()" class="btn-action btn-primary">🖼️ Export Image</button>
            <button (click)="printCurrentCard()" class="btn-action btn-primary">🖨️ Print</button>
          </div>
        </div>

        <!--Custom HTML/CSS Preview-->
        <div *ngIf="customCardHtml" class="custom-preview">
          <h4>🎨 Custom Design Preview</h4>
          <div [innerHTML]="customCardHtml" class="custom-card-container"></div>
          <style [innerHTML]="customCardCss"></style>
        </div>

        <!--Default Card Display-->
        <div *ngIf="!customCardHtml && currentCardData">
          <app-accreditation-card [data]="currentCardData" #accreditationCard></app-accreditation-card>
        </div>
      </div>
    </div>

    <!--Edit Mode-->
    <div *ngIf="viewMode === 'edit'" class="edit-mode">
      <app-card-editor
        *ngIf="currentCardData"
        [cardData]="currentCardData"
        (cardUpdated)="onCardUpdated($event)"
        (dataUpdated)="onCardDataUpdated($event)">
      </app-card-editor>
    </div>

    <!--Loading indicator-->
    <div *ngIf="isLoading" class="loading-overlay">
      <div class="loading-spinner">Loading...</div>
    </div>
  </main>

  <router-outlet></router-outlet>
</div>
